<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Billboard Texture Debug Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background: #000;
            color: #00ff00;
            font-family: monospace;
        }
        #info {
            position: absolute;
            top: 10px;
            left: 10px;
            z-index: 100;
            background: rgba(0, 0, 0, 0.8);
            padding: 10px;
            border: 1px solid #00ff00;
        }
        #canvasContainer {
            margin: 20px 0;
            border: 2px solid #00ff00;
            display: inline-block;
        }
    </style>
</head>
<body>
    <div id="info">
        <h3>Billboard Texture Debug</h3>
        <div id="status">Loading...</div>
        <div>Canvas below shows what should appear on billboards</div>
    </div>
    
    <div id="canvasContainer">
        <canvas id="testCanvas" width="512" height="256"></canvas>
    </div>
    
    <div id="three-container" style="width: 100%; height: 400px; border: 2px solid #00ff00; margin-top: 20px;"></div>

    <script type="module">
        import * as THREE from 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.min.js';

        // Create test canvas like in the game
        const canvas = document.getElementById('testCanvas');
        const context = canvas.getContext('2d');
        
        // Create Three.js scene for testing
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, 800/400, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(800, 400);
        document.getElementById('three-container').appendChild(renderer.domElement);
        
        // Create texture from canvas
        const texture = new THREE.CanvasTexture(canvas);
        texture.generateMipmaps = false;
        texture.wrapS = THREE.ClampToEdgeWrapping;
        texture.wrapT = THREE.ClampToEdgeWrapping;
        texture.minFilter = THREE.LinearFilter;
        texture.magFilter = THREE.LinearFilter;
        
        // Create test plane with the texture
        const geometry = new THREE.PlaneGeometry(4, 2);
        const material = new THREE.MeshBasicMaterial({
            map: texture,
            side: THREE.DoubleSide
        });
        const plane = new THREE.Mesh(geometry, material);
        scene.add(plane);
        
        // Position camera
        camera.position.z = 5;
        
        // Animation variables
        let animationTime = 0;
        const messages = ['JADARU RUNNER', 'HIGH SCORE', 'LEVEL UP!', 'GAME OVER'];
        let currentMessage = 0;
        
        // Update function
        function updateCanvas() {
            animationTime += 0.05;
            
            // Clear canvas
            context.fillStyle = '#001122';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // Test scrolling text
            const scrollOffset = (animationTime * 50) % (canvas.width + 200);
            
            context.shadowColor = '#00ffcc';
            context.shadowBlur = 20;
            context.fillStyle = '#00ffcc';
            context.font = 'bold 32px Arial';
            context.textAlign = 'left';
            context.textBaseline = 'middle';
            
            const message = messages[Math.floor(animationTime / 5) % messages.length];
            context.fillText(message, scrollOffset - 200, canvas.height / 2);
            
            // Add scan lines
            context.fillStyle = 'rgba(0, 0, 0, 0.1)';
            for (let i = 0; i < canvas.height; i += 4) {
                context.fillRect(0, i, canvas.width, 2);
            }
            
            // Update texture
            texture.needsUpdate = true;
            
            // Update status
            document.getElementById('status').innerHTML = `
                Time: ${animationTime.toFixed(2)}<br>
                Message: ${message}<br>
                Scroll: ${scrollOffset.toFixed(0)}<br>
                Texture updated: ${texture.needsUpdate}
            `;
        }
        
        // Render loop
        function animate() {
            requestAnimationFrame(animate);
            updateCanvas();
            renderer.render(scene, camera);
        }
        
        animate();
    </script>
</body>
</html>
