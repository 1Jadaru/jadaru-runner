<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Billboard Test</title>
    <style>
        body { margin: 0; background: #000; color: #0f0; font-family: monospace; }
        #info { position: absolute; top: 10px; left: 10px; z-index: 100; }
        canvas { border: 1px solid #0f0; }
    </style>
</head>
<body>
    <div id="info">
        <h3>Simple Billboard Test</h3>
        <div id="status">Loading...</div>
    </div>
    <canvas id="testCanvas" width="512" height="256"></canvas>
    <div id="three-container" style="width: 800px; height: 600px; border: 1px solid #0f0;"></div>

    <script type="module">
        import * as THREE from 'https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.module.min.js';

        // Create canvas
        const canvas = document.getElementById('testCanvas');
        const context = canvas.getContext('2d');
        
        // Create Three.js scene
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, 800/600, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer();
        renderer.setSize(800, 600);
        document.getElementById('three-container').appendChild(renderer.domElement);
        
        // Create texture and material
        const texture = new THREE.CanvasTexture(canvas);
        texture.generateMipmaps = false;
        texture.wrapS = THREE.ClampToEdgeWrapping;
        texture.wrapT = THREE.ClampToEdgeWrapping;
        texture.minFilter = THREE.LinearFilter;
        texture.magFilter = THREE.LinearFilter;
        
        const material = new THREE.MeshBasicMaterial({
            map: texture,
            side: THREE.DoubleSide
        });
        
        // Create billboard geometry and mesh
        const geometry = new THREE.PlaneGeometry(4, 2);
        const billboard = new THREE.Mesh(geometry, material);
        billboard.position.set(0, 0, -5);
        scene.add(billboard);
        
        // Position camera
        camera.position.set(0, 0, 0);
        camera.lookAt(0, 0, -5);
        
        let time = 0;
        
        function updateCanvas() {
            time += 0.05;
            
            // Clear canvas
            context.fillStyle = '#000011';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            // Draw test content
            const flash = Math.floor(time) % 2;
            context.fillStyle = flash ? '#ff0000' : '#00ffcc';
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            context.fillStyle = '#ffffff';
            context.font = 'bold 48px Arial';
            context.textAlign = 'center';
            context.textBaseline = 'middle';
            context.fillText('BILLBOARD TEST', canvas.width / 2, canvas.height / 2);
            
            // Force texture update
            texture.needsUpdate = true;
            
            document.getElementById('status').innerHTML = `Time: ${time.toFixed(2)}, Flash: ${flash}`;
        }
        
        function animate() {
            requestAnimationFrame(animate);
            updateCanvas();
            renderer.render(scene, camera);
        }
        
        animate();
    </script>
</body>
</html>
